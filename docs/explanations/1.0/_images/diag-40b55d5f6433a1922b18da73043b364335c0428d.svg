<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1335px" preserveAspectRatio="none" style="width:993px;height:1335px;" version="1.1" viewBox="0 0 993 1335" width="993px" zoomAndPan="magnify"><defs><filter height="300%" id="fgkymvudorv47" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[102bafc40486b76f3e165a6f6f8bdb7b]
cluster s_lb--><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="337" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="304" x="200" y="73"/><rect fill="#FFFFFF" height="304.2001" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="298" x="203" y="102.7999"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="200" x2="504" y1="99.7999" y2="99.7999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="193" x="255.5" y="90.9999">Check if connection is loopback</text><!--MD5=[ff1e671955e67b706ac467e2abb01e64]
cluster s2_p_id--><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="216" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="246" x="463" y="459"/><rect fill="#FFFFFF" height="183.2001" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="240" x="466" y="488.7999"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="463" x2="709" y1="485.7999" y2="485.7999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="230" x="471" y="476.9999">Get Process ID from  IPv4 connection</text><!--MD5=[984317297c45a2422f787341be44a96f]
cluster s3_p_id--><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="216" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="246" x="193" y="459"/><rect fill="#FFFFFF" height="183.2001" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="240" x="196" y="488.7999"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="193" x2="439" y1="485.7999" y2="485.7999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="230" x="201" y="476.9999">Get Process ID from  IPv6 connection</text><!--MD5=[02dcec7a96f47b5f7c1807dd6b9d150a]
cluster s4_m--><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="486" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="455" x="296" y="724"/><rect fill="#FFFFFF" height="453.2001" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="449" x="299" y="753.7999"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="751" y1="750.7999" y2="750.7999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="171" x="438" y="741.9999">Validate Executable Module</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="43.5999" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="245.5" y="108"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="250.5" y="126.9999">Is address family</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="266" y="143.7999">equal IPv4?</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="43.5999" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="216.5" y="229"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="221.5" y="247.9999">Is address family</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="237" y="264.7999">equal IPv6?</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="43.5999" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="366.5" y="229"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="371.5" y="247.9999">Is address subnet</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="372" y="264.7999">equal 127.0.0.0/8</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="43.5999" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="233.5" y="350"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="238.5" y="368.9999">Is address subnet</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="249" y="385.7999">equal ::1/128?</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="43.5999" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="495.5" y="494"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="510.5" y="512.9999">Enumerate all</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="500.5" y="529.7999">IPv4 connections</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="60.3998" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="479" y="599"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="129" x="504.5" y="617.9999">Find IPv4 connection</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="526" y="634.7999">with matching</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="170" x="484" y="651.5998">client and server addresses</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="43.5999" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="240.5" y="494"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="255.5" y="512.9999">Enumerate all</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="245.5" y="529.7999">IPv6 connections</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="60.3998" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="209" y="599"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="129" x="234.5" y="617.9999">Find IPv6 connection</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="256" y="634.7999">with matching</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="170" x="214" y="651.5998">client and server addresses</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="43.5999" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="546.5" y="759"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="551.5" y="777.9999">Read process</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="559" y="794.7999">version info</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="60.3998" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="548" y="880"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="580" y="898.9999">Compare version</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="96" x="584" y="915.7999">info to the list of</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="553" y="932.5998">well-known web-browsers</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="43.5999" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="573" y="1017"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="588.5" y="1035.9999">Detect module</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="578" y="1052.7999">validation method</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="40" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="206" x="529" y="1154"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="196" x="534" y="1179.6">Validate Authenticode signature</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="40" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="182" x="312" y="1154"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="172" x="317" y="1179.6">Validate Windows Resource</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="43.5999" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="7" y="494"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="67" y="512.9999">ERROR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="160" x="12" y="529.7999">not a loopback connection</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="43.5999" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="100.5" y="759"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="165" y="777.9999">ERROR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="169" x="105.5" y="794.7999">cannot find owning process</text><rect fill="#FEFECE" filter="url(#fgkymvudorv47)" height="43.5999" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="721" y="1273"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="780" y="1291.9999">ERROR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="726" y="1308.7999">invalid executable module</text><ellipse cx="303" cy="16" fill="#000000" filter="url(#fgkymvudorv47)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><ellipse cx="518" cy="1295" fill="none" filter="url(#fgkymvudorv47)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="518.5" cy="1295.5" fill="#000000" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><!--MD5=[1a03602b0b622cf1f1498983cd538467]
link *start to s1_ipv4_f--><path d="M303,26.17 C303,42.75 303,78.3 303,102.92 " fill="none" id="*start-&gt;s1_ipv4_f" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="303,108,307,99,303,103,299,99,303,108" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[7eaf80c6a6355bfed93cfb66f902fa20]
link s1_ipv4_f to s1_ipv6_f--><path d="M297.88,152 C293,172.01 285.65,202.21 280.39,223.79 " fill="none" id="s1_ipv4_f-&gt;s1_ipv6_f" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="279.16,228.81,285.1803,221.0154,280.3458,223.9526,277.4085,219.1181,279.16,228.81" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="291" y="196">No</text><!--MD5=[e81e3963f173a4d7fb34c7dc01c6bbb0]
link s1_ipv4_f to s1_ipv4_sn--><path d="M324.88,152 C346.18,172.44 378.54,203.49 401.1,225.15 " fill="none" id="s1_ipv4_f-&gt;s1_ipv4_sn" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="404.92,228.81,401.1811,219.6984,401.3068,225.3539,395.6513,225.4796,404.92,228.81" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="373" y="196">Yes</text><!--MD5=[6c124caaccf8279522146f9bb60be0c0]
link s1_ipv6_f to e1--><path d="M216.29,269.43 C195.33,277.52 172.33,288.59 154,303 C133.53,319.1 129.17,326.02 119,350 C99.42,396.17 93.97,455.16 92.5,488.65 " fill="none" id="s1_ipv6_f-&gt;e1" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="92.29,493.8,96.6213,484.9547,92.4756,488.8034,88.6268,484.6577,92.29,493.8" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="120" y="377.5">No</text><!--MD5=[92b5a47435e6842db03354f99b9dad5e]
link s1_ipv6_f to s1_ipv6_sn--><path d="M277.53,273 C280.89,293.01 285.97,323.21 289.6,344.79 " fill="none" id="s1_ipv6_f-&gt;s1_ipv6_sn" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="290.44,349.81,292.897,340.2726,289.6134,344.8788,285.0071,341.5951,290.44,349.81" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="286" y="317">Yes</text><!--MD5=[710b7c32f76a8722fee7d15d475663c9]
link s1_ipv4_sn to e1--><path d="M366.17,268.72 C337.59,277.47 303.42,289.23 274,303 C238.03,319.84 226.32,322.16 198,350 C155.13,392.14 120.97,454.65 103.9,489.38 " fill="none" id="s1_ipv4_sn-&gt;e1" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="101.7,493.88,109.2302,487.532,103.8845,489.3825,102.0341,484.0368,101.7,493.88" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="199" y="377.5">No</text><!--MD5=[bcfebb56543f883cb5916eee630016c9]
link s1_ipv6_sn to e1--><path d="M266.31,394.21 C247.73,408.3 222.62,427.06 200,443 C176.79,459.36 150.25,477.07 129.29,490.82 " fill="none" id="s1_ipv6_sn-&gt;e1" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="124.91,493.7,134.6301,492.1128,129.0921,490.9595,130.2454,485.4215,124.91,493.7" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="224" y="440">No</text><!--MD5=[8173b2d971f6e79503e814ad0937e98b]
link s1_ipv4_sn to s2_enum--><path d="M437.1,273.08 C460,320.88 515.81,437.38 540.69,489.3 " fill="none" id="s1_ipv4_sn-&gt;s2_enum" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="542.85,493.82,542.5666,483.9752,540.6887,489.3113,535.3526,487.4333,542.85,493.82" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="505" y="377.5">Yes</text><!--MD5=[f283f52d2e811762ba84328e0d0ab1f7]
link s1_ipv6_sn to s3_enum--><path d="M294.6,394.26 C295.31,419.36 296.48,461.12 297.25,488.35 " fill="none" id="s1_ipv6_sn-&gt;s3_enum" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="297.4,493.6,301.1413,484.4894,297.2572,488.602,293.1446,484.7179,297.4,493.6" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="296" y="440">Yes</text><!--MD5=[80c574f80e13ba61b44a032527e253bf]
link s2_enum to s2_find--><path d="M556.05,538.14 C558.32,553.89 561.47,575.74 564.09,593.94 " fill="none" id="s2_enum-&gt;s2_find" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="564.82,598.97,567.4917,589.4904,564.1049,594.0214,559.5739,590.6346,564.82,598.97" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[ce8bb48f962fa3814f275b4d0ed86a6d]
link s3_enum to s3_find--><path d="M298.19,538.14 C298.33,553.89 298.53,575.74 298.69,593.94 " fill="none" id="s3_enum-&gt;s3_find" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="298.74,598.97,302.6627,589.936,298.6971,593.9702,294.663,590.0046,298.74,598.97" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[51e751b77cf2197a468512ce7b123a21]
link s2_find to e2--><path d="M523.8,659.01 C494.11,676.49 453.73,697.37 415,708 C363.88,722.04 346.56,700.07 296,716 C268.63,724.62 240.98,741.66 220.78,755.99 " fill="none" id="s2_find-&gt;e2" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="216.59,759,226.2333,756.9981,220.6509,756.083,221.5661,750.5007,216.59,759" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="460" y="705">No</text><!--MD5=[99eb7ed87e3cc0974d25bd0871638c0a]
link s3_find to e2--><path d="M277.72,659.28 C257.61,686.96 227.74,728.07 208.57,754.45 " fill="none" id="s3_find-&gt;e2" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="205.58,758.55,214.1106,753.6276,208.5226,754.5076,207.6426,748.9196,205.58,758.55" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="255" y="705">No</text><!--MD5=[5ed6db3001f2b0131356c516f4c90493]
link s2_find to s4_vr--><path d="M573.88,659.28 C578.44,686.61 585.18,727.05 589.58,753.47 " fill="none" id="s2_find-&gt;s4_vr" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="590.43,758.55,592.9094,749.0183,589.615,753.6169,585.0164,750.3224,590.43,758.55" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="582" y="705">Yes</text><!--MD5=[847ce9a547190c03f947b986e3ee82bd]
link s3_find to s4_vr--><path d="M326.09,659.09 C342.45,675.29 364.45,694.79 387,708 C435.84,736.61 497.82,756.29 541.17,767.75 " fill="none" id="s3_find-&gt;s4_vr" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="546.1,769.03,538.4152,762.8701,541.2648,767.7568,536.3781,770.6064,546.1,769.03" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="388" y="705">Yes</text><!--MD5=[6e0a17ab56cac984720363b8c10e51ed]
link s4_vr to s4_vc--><path d="M600.36,803.26 C606.17,822.69 614.88,851.78 621.69,874.53 " fill="none" id="s4_vr-&gt;s4_vc" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="623.2,879.58,624.4586,869.8119,621.7698,874.7889,616.7928,872.1002,623.2,879.58" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="615" y="847">Yes</text><!--MD5=[4c30e8db90bf6823ea0e080ec1c18981]
link s4_vr to e3--><path d="M641.61,788.14 C741.54,802.36 964,841.59 964,909 C964,909 964,909 964,1175 C964,1221.81 919.28,1252.44 877.27,1270.89 " fill="none" id="s4_vr-&gt;e3" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="872.43,1272.96,882.2783,1273.0655,877.0205,1270.9784,879.1077,1265.7206,872.43,1272.96" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="965" y="1044.5">No</text><!--MD5=[8da7a9fd1dbe98c5b8e448888a5ae8fe]
link s4_vc to s4_mv--><path d="M632,940.14 C632,961.74 632,990.94 632,1011.81 " fill="none" id="s4_vc-&gt;s4_mv" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="632,1016.92,636,1007.92,632,1011.92,628,1007.92,632,1016.92" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="633" y="984">Yes</text><!--MD5=[0e16e7e8846ba6436576c2b354e907f7]
link s4_vc to e3--><path d="M663.97,940.27 C707.67,982.56 784.36,1065.44 817,1154 C830.69,1191.15 827,1203.86 821,1243 C819.74,1251.2 817.41,1259.9 814.91,1267.74 " fill="none" id="s4_vc-&gt;e3" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="813.34,1272.51,819.9611,1265.2188,814.9083,1267.7623,812.3648,1262.7095,813.34,1272.51" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="804" y="1113">No</text><!--MD5=[05524c0296510a78c63d02fa30c13acf]
link s4_mv to s4_as--><path d="M632,1061.07 C632,1084.87 632,1123.54 632,1148.62 " fill="none" id="s4_mv-&gt;s4_as" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="632,1153.75,636,1144.75,632,1148.75,628,1144.75,632,1153.75" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="634.5" y="1105">Mozilla Firefox,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="633" y="1120.6">Google Chrome</text><!--MD5=[5979a504c0b95490b880c0fb9aea98d2]
link s4_mv to s4_wr--><path d="M572.86,1049.73 C540.16,1057.18 500,1069.88 469,1091 C446.86,1106.08 428.44,1130.78 416.73,1149.13 " fill="none" id="s4_mv-&gt;s4_wr" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="413.9,1153.65,422.067,1148.1454,416.5538,1149.4124,415.2868,1143.8993,413.9,1153.65" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="470" y="1105">Microsoft Internet Explorer,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="501" y="1120.6">Microsoft EDGE</text><!--MD5=[79756528f50a7f6e79e6df1427cbdcfb]
link s4_mv to e3--><path d="M690.45,1061.1 C705.23,1068.68 720.01,1078.53 731,1091 C776.78,1142.95 795.02,1225.54 801.63,1267.56 " fill="none" id="s4_mv-&gt;e3" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="802.41,1272.73,805.0012,1263.2281,801.6529,1267.7876,797.0934,1264.4394,802.41,1272.73" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="792" y="1179.5">No</text><!--MD5=[b0dba03e569f96e2e3a12201ea5e38bd]
link s4_as to e3--><path d="M659.8,1194.12 C689.78,1214.74 737.58,1247.62 770.08,1269.98 " fill="none" id="s4_as-&gt;e3" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="774.36,1272.92,769.2097,1264.5251,770.2398,1270.0874,764.6775,1271.1174,774.36,1272.92" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="729" y="1240">No</text><!--MD5=[1c7169990d35cce453fdcd9eb745d8b2]
link s4_wr to e3--><path d="M435.66,1194.04 C463.18,1209.34 504.04,1230.28 542,1243 C598.5,1261.93 664.32,1274.68 715.98,1282.71 " fill="none" id="s4_wr-&gt;e3" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="720.93,1283.47,712.6394,1278.1534,715.9876,1282.7129,711.4281,1286.0612,720.93,1283.47" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="543" y="1240">No</text><!--MD5=[4111537850817295cc2bcb1be59624a1]
link s4_as to *end--><path d="M613.68,1194.12 C589.37,1219.5 547.29,1263.43 528.08,1283.48 " fill="none" id="s4_as-&gt;*end" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="524.56,1287.16,533.6793,1283.4399,528.0235,1283.5539,527.9095,1277.8982,524.56,1287.16" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="582" y="1240">Yes</text><!--MD5=[cabe08c7c2d3676157a4c73b85e8ce29]
link s4_wr to *end--><path d="M420.78,1194.2 C433.54,1207.9 451.2,1226.71 467,1243 C480.86,1257.28 497.16,1273.48 507.54,1283.72 " fill="none" id="s4_wr-&gt;*end" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="511.33,1287.46,507.7388,1278.2892,507.7731,1283.946,502.1164,1283.9802,511.33,1287.46" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="468" y="1240">Yes</text><!--MD5=[273a75883adc92199c660f030f792b17]
@startuml
hide empty description

state "Check if connection is loopback" as s_lb {
  state "Is address family\nequal IPv4?"       as s1_ipv4_f
  state "Is address family\nequal IPv6?"       as s1_ipv6_f
  state "Is address subnet\nequal 127.0.0.0/8" as s1_ipv4_sn
  state "Is address subnet\nequal ::1/128?"    as s1_ipv6_sn
}

state "Get Process ID from  IPv4 connection" as s2_p_id {
  state "Enumerate all\nIPv4 connections" as s2_enum
  state "Find IPv4 connection\nwith matching\nclient and server addresses" as s2_find
}

state "Get Process ID from  IPv6 connection" as s3_p_id {
  state "Enumerate all\nIPv6 connections" as s3_enum
  state "Find IPv6 connection\nwith matching\nclient and server addresses" as s3_find
}

state "Validate Executable Module" as s4_m {
  state "Read process\nversion info" as s4_vr
  state "Compare version\ninfo to the list of\nwell-known web-browsers" as s4_vc
  state "Detect module\nvalidation method" as s4_mv
  state "Validate Authenticode signature" as s4_as
  state "Validate Windows Resource" as s4_wr
}

state "ERROR\nnot a loopback connection" as e1
state "ERROR\ncannot find owning process" as e2
state "ERROR\ninvalid executable module" as e3

[*]        - -> s1_ipv4_f
s1_ipv4_f  - -> s1_ipv6_f: No
s1_ipv4_f  - -> s1_ipv4_sn: Yes
s1_ipv6_f  - -> e1 : No
s1_ipv6_f  - -> s1_ipv6_sn : Yes
s1_ipv4_sn - -> e1 : No
s1_ipv6_sn - -> e1 : No

s1_ipv4_sn - -> s2_enum : Yes
s1_ipv6_sn - -> s3_enum : Yes

s2_enum - -> s2_find
s3_enum - -> s3_find

s2_find - -> e2 : No
s3_find - -> e2 : No

s2_find - -> s4_vr : Yes
s3_find - -> s4_vr : Yes

s4_vr - -> s4_vc : Yes
s4_vr - -> e3 : No
s4_vc - -> s4_mv : Yes
s4_vc - -> e3 : No
s4_mv - -> s4_as : Mozilla Firefox,\nGoogle Chrome
s4_mv - -> s4_wr : Microsoft Internet Explorer,\nMicrosoft EDGE
s4_mv - -> e3 : No
s4_as - -> e3 : No
s4_wr - -> e3 : No

s4_as - -> [*] : Yes
s4_wr - -> [*] : Yes
@enduml

PlantUML version 1.2020.15(Sun Jun 28 11:39:45 GMT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>